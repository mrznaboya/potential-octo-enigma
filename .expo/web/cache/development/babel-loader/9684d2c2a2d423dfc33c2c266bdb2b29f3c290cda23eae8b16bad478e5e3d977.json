{"ast":null,"code":"function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\nimport { PermissionStatus } from \"./Permissions.types\";\nfunction _getUserMedia(constraints) {\n  if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n    return navigator.mediaDevices.getUserMedia(constraints);\n  }\n  var getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || function () {\n    var error = new Error('Permission unimplemented');\n    error.code = 0;\n    error.name = 'NotAllowedError';\n    throw error;\n  };\n  return new Promise((resolve, reject) => {\n    getUserMedia.call(navigator, constraints, resolve, reject);\n  });\n}\nfunction askForMediaPermissionAsync(_x) {\n  return _askForMediaPermissionAsync.apply(this, arguments);\n}\nfunction _askForMediaPermissionAsync() {\n  _askForMediaPermissionAsync = _asyncToGenerator(function* (options) {\n    try {\n      yield _getUserMedia(options);\n      return {\n        status: PermissionStatus.GRANTED,\n        expires: 'never'\n      };\n    } catch ({\n      message\n    }) {\n      if (message === 'Permission dismissed') {\n        return {\n          status: PermissionStatus.UNDETERMINED,\n          expires: 'never'\n        };\n      } else {\n        return {\n          status: PermissionStatus.DENIED,\n          expires: 'never'\n        };\n      }\n    }\n  });\n  return _askForMediaPermissionAsync.apply(this, arguments);\n}\nfunction askForMicrophonePermissionAsync() {\n  return _askForMicrophonePermissionAsync.apply(this, arguments);\n}\nfunction _askForMicrophonePermissionAsync() {\n  _askForMicrophonePermissionAsync = _asyncToGenerator(function* () {\n    return yield askForMediaPermissionAsync({\n      audio: true\n    });\n  });\n  return _askForMicrophonePermissionAsync.apply(this, arguments);\n}\nfunction askForCameraPermissionAsync() {\n  return _askForCameraPermissionAsync.apply(this, arguments);\n}\nfunction _askForCameraPermissionAsync() {\n  _askForCameraPermissionAsync = _asyncToGenerator(function* () {\n    return yield askForMediaPermissionAsync({\n      video: true\n    });\n  });\n  return _askForCameraPermissionAsync.apply(this, arguments);\n}\nfunction askForLocationPermissionAsync() {\n  return _askForLocationPermissionAsync.apply(this, arguments);\n}\nfunction _askForLocationPermissionAsync() {\n  _askForLocationPermissionAsync = _asyncToGenerator(function* () {\n    return new Promise(resolve => {\n      navigator.geolocation.getCurrentPosition(() => resolve({\n        status: PermissionStatus.GRANTED,\n        expires: 'never'\n      }), _ref => {\n        var {\n          code\n        } = _ref;\n        if (code === 1) {\n          resolve({\n            status: PermissionStatus.DENIED,\n            expires: 'never'\n          });\n        } else {\n          resolve({\n            status: PermissionStatus.UNDETERMINED,\n            expires: 'never'\n          });\n        }\n      });\n    });\n  });\n  return _askForLocationPermissionAsync.apply(this, arguments);\n}\nfunction getPermissionAsync(_x2, _x3) {\n  return _getPermissionAsync.apply(this, arguments);\n}\nfunction _getPermissionAsync() {\n  _getPermissionAsync = _asyncToGenerator(function* (permission, shouldAsk) {\n    switch (permission) {\n      case 'userFacingNotifications':\n      case 'notifications':\n        {\n          var {\n            Notification = {}\n          } = window;\n          if (Notification.requestPermission) {\n            var status = Notification.permission;\n            if (shouldAsk) {\n              status = yield Notification.requestPermission();\n            }\n            if (!status || status === 'default') {\n              return {\n                status: PermissionStatus.UNDETERMINED,\n                expires: 'never'\n              };\n            }\n            return {\n              status,\n              expires: 'never'\n            };\n          }\n        }\n        break;\n      case 'location':\n        {\n          var {\n            navigator: _navigator = {}\n          } = window;\n          if (_navigator.permissions) {\n            var {\n              state\n            } = yield _navigator.permissions.query({\n              name: 'geolocation'\n            });\n            if (state !== PermissionStatus.GRANTED && state !== PermissionStatus.DENIED) {\n              if (shouldAsk) {\n                return yield askForLocationPermissionAsync();\n              }\n              return {\n                status: PermissionStatus.UNDETERMINED,\n                expires: 'never'\n              };\n            }\n            return {\n              status: state,\n              expires: 'never'\n            };\n          } else if (shouldAsk) {\n            return yield askForLocationPermissionAsync();\n          }\n        }\n        break;\n      case 'audioRecording':\n        if (shouldAsk) {\n          return yield askForMicrophonePermissionAsync();\n        } else {}\n        break;\n      case 'camera':\n        if (shouldAsk) {\n          return yield askForCameraPermissionAsync();\n        } else {}\n        break;\n      default:\n        break;\n    }\n    return {\n      status: PermissionStatus.UNDETERMINED,\n      expires: 'never'\n    };\n  });\n  return _getPermissionAsync.apply(this, arguments);\n}\nexport default {\n  get name() {\n    return 'ExpoPermissions';\n  },\n  getAsync(permissionTypes) {\n    return _asyncToGenerator(function* () {\n      var results = {};\n      for (var permissionType of new Set(permissionTypes)) {\n        results[permissionType] = yield getPermissionAsync(permissionType, false);\n      }\n      return results;\n    })();\n  },\n  askAsync(permissionTypes) {\n    return _asyncToGenerator(function* () {\n      var results = {};\n      for (var permissionType of new Set(permissionTypes)) {\n        results[permissionType] = yield getPermissionAsync(permissionType, true);\n      }\n      return results;\n    })();\n  }\n};","map":{"version":3,"names":["PermissionStatus","_getUserMedia","constraints","navigator","mediaDevices","getUserMedia","webkitGetUserMedia","mozGetUserMedia","error","Error","code","name","Promise","resolve","reject","call","askForMediaPermissionAsync","_x","_askForMediaPermissionAsync","apply","arguments","_asyncToGenerator","options","status","GRANTED","expires","message","UNDETERMINED","DENIED","askForMicrophonePermissionAsync","_askForMicrophonePermissionAsync","audio","askForCameraPermissionAsync","_askForCameraPermissionAsync","video","askForLocationPermissionAsync","_askForLocationPermissionAsync","geolocation","getCurrentPosition","_ref","getPermissionAsync","_x2","_x3","_getPermissionAsync","permission","shouldAsk","Notification","window","requestPermission","permissions","state","query","getAsync","permissionTypes","results","permissionType","Set","askAsync"],"sources":["/Users/zuyax/Developer/rn-starter/node_modules/expo-permissions/src/ExpoPermissions.web.ts"],"sourcesContent":["import {\n  PermissionInfo,\n  PermissionMap,\n  PermissionStatus,\n  PermissionType,\n} from './Permissions.types';\n\n/*\n * TODO: Bacon: https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia#Permissions\n * Add messages to manifest like we do with iOS info.plist\n */\n\n// https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia#Using_the_new_API_in_older_browsers\n// Older browsers might not implement mediaDevices at all, so we set an empty object first\nfunction _getUserMedia(constraints: MediaStreamConstraints): Promise<MediaStream> {\n  if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n    return navigator.mediaDevices.getUserMedia(constraints);\n  }\n\n  // Some browsers partially implement mediaDevices. We can't just assign an object\n  // with getUserMedia as it would overwrite existing properties.\n  // Here, we will just add the getUserMedia property if it's missing.\n\n  // First get ahold of the legacy getUserMedia, if present\n  const getUserMedia =\n    navigator.getUserMedia ||\n    (navigator as any).webkitGetUserMedia ||\n    (navigator as any).mozGetUserMedia ||\n    function() {\n      const error: any = new Error('Permission unimplemented');\n      error.code = 0;\n      error.name = 'NotAllowedError';\n      throw error;\n    };\n\n  return new Promise((resolve, reject) => {\n    getUserMedia.call(navigator, constraints, resolve, reject);\n  });\n}\n\nasync function askForMediaPermissionAsync(\n  options: MediaStreamConstraints\n): Promise<PermissionInfo> {\n  try {\n    await _getUserMedia(options);\n    return { status: PermissionStatus.GRANTED, expires: 'never' };\n  } catch ({ message }) {\n    // name: NotAllowedError\n    // code: 0\n    if (message === 'Permission dismissed') {\n      // message: Permission dismissed\n      return { status: PermissionStatus.UNDETERMINED, expires: 'never' };\n    } else {\n      // TODO: Bacon: [OSX] The system could deny access to chrome.\n      // TODO: Bacon: add: { status: 'unimplemented' }\n      // message: Permission denied\n      return { status: PermissionStatus.DENIED, expires: 'never' };\n    }\n  }\n}\n\nasync function askForMicrophonePermissionAsync(): Promise<PermissionInfo> {\n  return await askForMediaPermissionAsync({ audio: true });\n}\n\nasync function askForCameraPermissionAsync(): Promise<PermissionInfo> {\n  return await askForMediaPermissionAsync({ video: true });\n}\n\nasync function askForLocationPermissionAsync(): Promise<PermissionInfo> {\n  return new Promise(resolve => {\n    navigator.geolocation.getCurrentPosition(\n      () => resolve({ status: PermissionStatus.GRANTED, expires: 'never' }),\n      ({ code }: PositionError) => {\n        // https://developer.mozilla.org/en-US/docs/Web/API/PositionError/code\n        if (code === 1) {\n          resolve({ status: PermissionStatus.DENIED, expires: 'never' });\n        } else {\n          resolve({ status: PermissionStatus.UNDETERMINED, expires: 'never' });\n        }\n      }\n    );\n  });\n}\n\nasync function getPermissionAsync(\n  permission: PermissionType,\n  shouldAsk: boolean\n): Promise<PermissionInfo> {\n  switch (permission) {\n    case 'userFacingNotifications':\n    case 'notifications':\n      {\n        const { Notification = {} } = window as any;\n        if (Notification.requestPermission) {\n          let status = Notification.permission;\n          if (shouldAsk) {\n            status = await Notification.requestPermission();\n          }\n          if (!status || status === 'default') {\n            return { status: PermissionStatus.UNDETERMINED, expires: 'never' };\n          }\n          return { status, expires: 'never' };\n        }\n      }\n      break;\n    case 'location':\n      {\n        const { navigator = {} } = window as any;\n        if (navigator.permissions) {\n          const { state } = await navigator.permissions.query({ name: 'geolocation' });\n          if (state !== PermissionStatus.GRANTED && state !== PermissionStatus.DENIED) {\n            if (shouldAsk) {\n              return await askForLocationPermissionAsync();\n            }\n            return { status: PermissionStatus.UNDETERMINED, expires: 'never' };\n          }\n\n          return { status: state, expires: 'never' };\n        } else if (shouldAsk) {\n          // TODO: Bacon: should this function as ask async when not in chrome?\n          return await askForLocationPermissionAsync();\n        }\n      }\n      break;\n    case 'audioRecording':\n      if (shouldAsk) {\n        return await askForMicrophonePermissionAsync();\n      } else {\n        //TODO: Bacon: Is it possible to get this permission?\n      }\n      break;\n    case 'camera':\n      if (shouldAsk) {\n        return await askForCameraPermissionAsync();\n      } else {\n        //TODO: Bacon: Is it possible to get this permission?\n      }\n      break;\n    default:\n      break;\n  }\n  return { status: PermissionStatus.UNDETERMINED, expires: 'never' };\n}\n\nexport default {\n  get name(): string {\n    return 'ExpoPermissions';\n  },\n\n  async getAsync(permissionTypes: PermissionType[]): Promise<PermissionMap> {\n    const results = {};\n    for (const permissionType of new Set(permissionTypes)) {\n      results[permissionType] = await getPermissionAsync(permissionType, /* shouldAsk */ false);\n    }\n    return results;\n  },\n\n  async askAsync(permissionTypes: PermissionType[]): Promise<PermissionMap> {\n    const results = {};\n    for (const permissionType of new Set(permissionTypes)) {\n      results[permissionType] = await getPermissionAsync(permissionType, /* shouldAsk */ true);\n    }\n    return results;\n  },\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}